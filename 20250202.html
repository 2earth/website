<!DOCTYPE html>

<html>
<head>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="./style.css" type="text/css" rel="stylesheet">
	<meta charset="UTF-8"> 
</head>

<title>TR | 2025-02-02</title>

<body>

	<div class="header">
		<span style="display:inline-block; width: 40%; font-size: 24px">Tom Ruddell</span><span style="display:inline-block; width: 60%; margin-left: 0%;text-align: right;"><a href="./pages.html">pages</a> / <a href="./index.html">about</a> / <a href="./subscribe.html">follow</a></span>
		<div class="separator"></div>
	</div>

	<div class="main">
		<span class="title"><p><b>Celtic Code: Drawing knots with Python</b></p></span>
		<span class="body"><i>2nd February 2025</i></span>
		<div class="separator"></div>
		<div class="body">
			<p></p><p></p>
			
			<div class="breakout">
			<p>I have made a web app that uses Python to create Celtic knots and it's <i>really fun!</i><p>
			</div>
			<p><b>Go-to ></b><a href="#project"> The programming project</a>
			<p><b>Go-to ></b><a href="#knotiframe"> The web-app</a>
			<p><b>Go-to ></b><a href="https://pyscript.com/@2earth/celtic-knot/latest?files=README.md"> The source code</a>
			<p></p>
			<img src="./assets/20250202/20250202-1.png" alt="An example Celtic knot, drawn programmatically">
			<p><b>Above:</b> An example Celtic knot, drawn programmatically</p>
			
			<p><i>The Celts were dispersed tribes of peoples with a shared linguistic and cultural history which lives on today in modern languages, especially Welsh, Irish and Scottish Gaelic. This post takes the instantly-recognisable Celtic knot as a jumping-off point for briefly exploring the history of the Celts and rope/knots before detailing how I programmed a web app to create Celtic knots in just a few clicks.</i></p>
			<p></p>
			<b>The Celtic Peoples</b>
			<p>The “Celtic Peoples” lived across Europe and Western Asia but their origin is essentially contested, with theories debating Westwards, Eastwards, or even Outwards (from the centre) expansion. Early linguistic roots are proposed to have emerged between 3000-1000 BC, with Celtic languages becoming more defined around 400 BC. </p>
			<p>By 500 AD the expansion of the Roman Empire restricted the Celts to Ireland, Western and Northern Britain and Brittainy, in turn leading to greater socio-cultural cohesion <a href="https://en.wikipedia.org/wiki/Celts">(ref)</a>. It’s in those regions that the archaeological record and cultural legacy of the Celts is most pronounced. In Glasgow, evidence of the <a href="https://en.wikipedia.org/wiki/Kingdom_of_Strathclyde">Kingdom of Strathclyde</a> includes the Govan Stones, a series of carved sarcophagi, crosses and hogbacks (in turn a result of Viking influence). Around the same time (c 800 AD) the <a href="https://en.wikipedia.org/wiki/Book_of_Kells">Book of Kells</a> was made in Ireland or Scotland, featuring lavish decoration featuring highly complex Celtic knots in many styles throughout. </p>
			<p></p>
			<b>Utility and knowledge; can-knot or can-not</b>
			<p>Obviously, knots serve a primarily utilitarian function and are likely one of the oldest human technologies. The archaeological record for knots is limited by the degredation of rope, so the earliest evidence of their invention is simply holes in stone or bone tools, or pieces which would have been tied together, such as a flint to a spear.</p>
			<p>Knots are themselves immaterial, being formed from a relative motion of strands and objects, but completely transform the usefulness of the thing(s) they tie together, and the medium they are tied into. Knots can connect, slide, release, hold, restrain, transmit; there are an unknowable number of different knots and each is intentionally selected for its properties. Knowledge of a specific knot provides access to the properties it provides, if not, not. </p>
			<p>Knots are, in various activities, essential knowledge without which you simply cannot participate. In my life the figure-of-eight knot is a prerequisite for climbing – it’s simple, easy to inspect and self-tightening yet easy to loosen even after a fall. In a broader context, knots have been used throughout history for diverse needs. Construction, fishing, record-keeping, decoration, textiles and equipment for warfare – they all need knots.</p>
			<p></p>
			<b>Knots today</b>
			<p>Are knots now an irrelevant relic of the pre-digital age? No, but I think the role of knots as a technology has changed along with our materials and needs. Division of labour has kindly relieved me, the office worker, of the need to know how to tie more than my climbing rope, shoelaces and, occasionally, a formal tie. Contemporary ropes are predominantly synthetic and in many applications replaced by alternative technologies like tape or metal cable, yet, in certain contexts, ropes (and thus knots) stubbornly persist. </p>
			<p>It’s hard to imagine the obsolescence of ropes and knots in activities like (small-medium scale) fishing, climbing or camping. I wonder if this has to do with the flexibility, independence and human-scale of knotting combined with the impressive strength to weight ratio, corrosion resistance and durability of synthetic ropes. </p>
			<p><a href="https://en.wikipedia.org/wiki/Rope">Ropes themselves</a> have undergone continuous technological development in manufacturing methods, materials and design (I recommend <a href="https://solar.lowtechmagazine.com/2010/06/lost-knowledge-ropes-and-knots/">this</a> interesting if slightly nostalgic article on the topic on lowtech magazine). Ropes are either braided or twisted (digression: <a href="https://www.iso.org/standard/3563.html">ISO 2</a> defines the direction of rope twist. ISO 1 defines a standard reference temperature) and are today made from a wide variety of primarily synthetic materials such as Polypropylene, Nylon, Polyester but also natural materials such as cotton, hemp, manila and sisal. Composites can be constructed to combine the desireable qualities of multiple materials. Synthetics have the advantage of greater strength, lower cost and reduced biodegradability and can be made to float - with obvious benefits. Incidentally, the primary function of twisting or braiding fibres to form rope is to distribute tension better between all fibres, rather than loading fibres in order of length.</p> 
			<p>Today we are more likely to be interacting with cables than ropes. Modern electrical cables, electromagnets and motor windings all depend on highly technical and exact braids, coils and windings for their engineered functions. Coiling and the use of several strands in electrical cables provides flexibility, redundancy and a higher current carrying capacity than a solid conductor would. Cable screening, shielding and armour all provide essential mechanical or electromagnetic interference protective properties and motor or generator windings exploit the electromagnetic effect to translate electricity to rotation or vice versa. Cables are not ropes and windings are not knots, yet some of the essential properties of each persist in these modern applications.</p>
			<p></p>
			<b>Geometric appeal</b>
			<p>Save for upbringing and environment, we are cognitively very similar to the 8th century Celt. While inventing and learning basic knots is no longer at the technological cutting edge, perhaps there is a distant lineage to today’s complex manipulation of cable and wire for electrical and digital needs. </p>
			<p>That more abstract representations of these patterns as geometric forms finds an expression as an artform suggests, to me anyway, an appeal to interest and intellect. Perhaps having the capacity to finding interest in such complexities encourages us to experiment and learn, thus resulting in indirect survival benefits through knowledge and innovation. Does the expression of art arise partly from this same mechanism?</p>
			<p>Many cultures have also used knots to express metaphors; the pattern of 4 snakes coming from a central boss, as featured on the Celtic “Sun Stone” in Govan is apparently an early Christian metaphor for rebirth, based on how snakes shed their skin <a href="https://earlymedievalgovan.wordpress.com/2012/01/05/the-sun-stone/">(ref)</a>. The <a href="https://en.wikipedia.org/wiki/Ouroboros">Ouroboros motif</a> appears in many cultures and features a snake or dragon consuming its own tail, symbolising the cycle of life (among other concepts).</p>
			<p>On a more abstract level, that a knot makes two strands into one is conceptually interesting; adding in ideas like the endless knot and symmetry or applying geometric visual patterns can make knots compelling to look at as an artform. </p>
			<p>Both physical and geometric infinite knots crop up throughout history in many cultures. Some more or less related examples include <a href="https://en.wikipedia.org/wiki/Korean_knots">Korean knots (Maedeup)</a>, <a href="https://en.wikipedia.org/wiki/Chinese_knotting">Chinese knots</a>, <a href="https://en.wikipedia.org/wiki/Kolam">Kolam</a> (where “the lines must be completed to symbolically prevent evil spirits from entering the inside of the shapes”), <a href="https://en.wikipedia.org/wiki/Valknut">Valknut</a> and <a href="https://en.wikipedia.org/wiki/Islamic_geometric_patterns">Islamic geometric art</a>. The Romans used various repeating and interlocking patterns in mosaics – a particular example is <a href="https://en.wikipedia.org/wiki/Solomon%27s_knot">Solomon’s knot</a>.</p>
			<p></p>
			<span id="project"><b>The project</b></span>
			<p>Musings aside, let’s try and code a program which draws Celtic knots programmatically! The Celts would have loved it!</p>
			<p>The reason for using Python is, obviously, a cultured reference to the Ouroboros or twisting serpents motif symbols. Conveniently it's also the only programming language I'm familiar with today and that I wanted to try out <a href="https://pyscript.net/">PyScript</a>, which uses <a href="https://developer.mozilla.org/en-US/docs/WebAssembly">WebAssembly</a> to run a compact Python interpreter directly inside your browser.</p>
			<p>Stylistically, the target knot is rectilinear and thus relatively simple – more akin to carved examples than the more organic illustrated examples found in the Book of Kells. </p>
			<p></p>
			<b>Basic research: easy for humans, hard for computers</b>
			<p>Drawing Celtic knots well, or with complex patterns, is very challenging – but the basics are not. <a href="https://en.wikipedia.org/wiki/George_Bain_(artist)">George Bain</a> introduces 4 stages:</p>
			<ol>
				<li>Draw a pattern of dots and then draw lines which connect the dots</li>
				<li>Create an outline around the lines</li>
				<li>Erase the crossing points</li>
				<li>Replace each crossing point with an “over” or “under”</li>
			</ol>
			<p>This set of instructions is quite easy for humans but totally insufficient for creating a computer program, which needs every action to be rigorously defined! Looking for “the maths of Celtic Knots” I had to steer clear from papers on knot theory, but did find <a href="https://www.maths.ed.ac.uk/~v1ranick/knots/celtic.pdf">a great 2012 undergraduate paper</a> from the University of Edinburgh “Celtic Knot Theory” which provided some rules I could use as a starting point. My thanks to the authors! After a lot of thought and some trial and error, I came out with a working program.</p>
			<p></p>
			<b>Celtic Computing: Coding a Celtic Knot</b>
			<p>Bear in mind that the following is simplified for brevity and to focus on the key points. The full program is available here. Let’s get started!</p>
			<div style="border-left: 5px solid; border-color: rgb(91, 70, 54); padding-left: 10px; padding-top: 0px; padding-bottom: 0px;">
				<p><b>Step 1: Create a grid</b></p>
				<p>We need to create two arrays. The first “tile array” will hold the information about each segment of the knot, which we will break up into “tiles”. This array will have dimensions <code>m x n</code>, where <code>m</code> and <code>n</code> are both even. This array will be populated with 5 different types of tile: Corners, Straights, Right-bends, Left-bends, and diagonals. </p>
				<p>The second “barrier array” will be for barriers and will have dimensions <code>2m x 2n</code>. Every second node in the array represents a point between two adjacent tiles, and the outer rows and columns represent the perimeter of the tile array.</p>
				<img class="responsive-img" style="width: 30%;" src="./assets/20250202/20250202-2.png" alt="Step 1">
			</div>
			<p></p>
			<div style="border-left: 5px solid; border-color: rgb(91, 70, 54); padding-left: 10px; padding-top: 0px; padding-bottom: 0px;">
				<b>Step 2: Create barriers to guide the knot</b>
				<p>Next, we need to establish barriers, which will constrain the motion of the Celtic knot. The whole perimeter of the barrier array must be blocked off, and for decorative effect let’s add some inside the array too – let’s do this manually because it’s the creative input to the process. But, bear in mind that not all barrier arrangements result in a valid solution and some experimentation is required!</p>
				<img class="responsive-img" style="width: 30%;" src="./assets/20250202/20250202-3.png" alt="Step 2">
			</div>
			<p></p>
			<div style="border-left: 5px solid; border-color: rgb(91, 70, 54); padding-left: 10px; padding-top: 0px; padding-bottom: 0px;">	
				<p><b>Step 3: Calculate the number of adjacent barriers</b></p>
				<p>We need to iterate through the tile array, counting the number of neighbouring barriers. We will use this information in the next step to work out what the knot is doing in each tile.</p>
				<img class="responsive-img" style="width: 30%;" src="./assets/20250202/20250202-4.png" alt="Step 3">
			</div>
			<p></p>
			<div style="border-left: 5px solid; border-color: rgb(91, 70, 54); padding-left: 10px; padding-top: 0px; padding-bottom: 0px;">	
				<p><b>Step 4: Determine each tile’s “type”</b></p>
				<p>With the barrier count from the previous step we can immediately determine quite a lot about our knot. Depending on the number of neighbouring barriers, tiles are either:</p>
				<table>
					<thread>
					</thread>
					<tbody>
						<tr>
							<th scope="row">0: </th>
							<td>diagonal</td>
						</tr>
						<tr>
							<th scope="row">1: </th>
							<td>bend (direction and orientation is not yet known)</td>
						</tr>
						<tr>
							<th scope="row">2: </th>
							<td>corner or straight</td>
						</tr>
					</tbody>
				</table>
				<p></p>
				<img class="responsive-img" style="width: 60%" src="./assets/20250202/20250202-5.png" alt="Step 4">
			</div>
			<p>This is a good start, but there’s a lot we don’t know yet – we haven’t rotated each segment yet. There are a total of 16 different tile types / rotations, so we need more information before we can start to draw our knot.</p>
			<img class="responsive-img" style="width: 80%" src="./assets/20250202/20250202-6.png" alt="Step 4">
			<p>Let’s write down what we know so far:</p>
			<p></p>
			<img class="responsive-img" style="width: 40%" src="./assets/20250202/20250202-7.png" alt="Step 4">
			<p></p>
			<div style="border-left: 5px solid; border-color: rgb(91, 70, 54); padding-left: 10px; padding-top: 0px; padding-bottom: 0px;">	
				<p><b>Step 5: Place diagonal, straight and corner tiles</b></p>
				<p>Let’s work out the details for the diagonal, straight and corner tiles. We will leave the bends for the time being as they require a bit more thought.</p>
				<p>To help with this and following steps, we can set up a simple “compass”. Starting from “0” at North, “1” at North-East and proceeding clockwise to “7” at North-West, this turns out to be really helpful in computing the knot programmatically. For each tile, we can thus record the “entry” and “exit” directions (the order being unimportant for this program, we can adopt a simple convention of lower number first). </p>
				<img class="responsive-img" style="width: 50%" src="./assets/20250202/20250202-8.png" alt="A compass to help calculate rope entry and exit points">
				<p>With that in place we can continue placing the diagonals and straight tiles. </p>
				<p>Let’s place diagonals on tiles with no neighbouring barriers. These will go:</p>
				<div class="code-container">
					<code>
						<p>if (row+column) is odd:</p>
						<p>&nbsp direction is NW to SE</p>
						<p>if (row+column) is even:</p>
						<p>&nbsp direction is NE to SW</p>
					</code>
				</div>
				<p>On tiles with 2 neighbouring barriers, we can apply a quick check to find out whether these barriers are adjacent or parallel. Knowing whether the tile is a diagonal or straight, we can then determine the rotation of the tile.</p>
				<img class="responsive-img" style="width: 40%" src="./assets/20250202/20250202-10.png" alt="Step 5">
			</div>
			<p></p>
			<div style="border-left: 5px solid; border-color: rgb(91, 70, 54); padding-left: 10px; padding-top: 0px; padding-bottom: 0px;">	
				<p><b>Step 6: Place bend tiles</b></p>
				<p>The hardest step - placing the bend tiles using the following method:</p>
				<ol style="list-style-type: decimal;">
					<li>Determine if the bend is left- or right-handed:</li>
						<ol style="list-style-type: lower-alpha;">
							<p></p>
							<div class="code-container">
								<code>
									<p>if [b horizontal and (x+y) even] OR [b vertical and (x+y) odd]:</p>
									<p>&nbsp bend is left</p>
									<p>if [b horizontal and (x+y) odd] OR [b vertical and (x+y) even]:</p>
									<p>&nbsp bend is right</p>
								</code>
							</div>
						<p></p>
						</ol>
					<li>Find the barrier adjacent to the tile and use this information to bend 45° away from the barrier, with the correct starting direction</li>
				</ol>
				<p>To take an example, if the bend tile has a barrier to the North (0) then the entry must either be East (2) if the bend is left-handed or West (6) if right-handed. (We can infer that because a left-handed curve starting from the West would collide with the North barrier). </p>
				<p>The corresponding exit is then the entry direction +3 so 5 (i.e. 135° clockwise) if left-handed or +5 so 11 (i.e. 225° clockwise) if right-handed. </p>
				<p>In the above case, where the direction spills over 7, we can clip it back to our 0-7 range (<code>11 % 8 = 3</code> i.e. South-East). </p>
				<p></p>
				<img style="width: 100%" src="./assets/20250202/20250202-11.png" alt="Step 6">
				<p>Given that the result will always be the same for a given barrier orientation and “handedness” we can set up a lookup table to access the solution quickly, simply based on knowing the location of the adjacent barrier and the handedness of the bend.</p>
				<div class="code-container">
					<code>
						<p>left_bend = {0: [5, 2], 2: [7, 4], 4: [1, 6], 6: [3,0]}</p>
						<p>right_bend = {0: [3, 6], 2: [5, 0], 4: [7, 2], 6: [1,4]}</p>
					</code>
				</div>
				<p>This provides us with all the information needed to complete the solution of the Celtic knot:</p>
				<img class="responsive-img" style="width: 65%" src="./assets/20250202/20250202-12.png" alt="Step 6">
			</div>
			<p></p>
			<div style="border-left: 5px solid; border-color: rgb(91, 70, 54); padding-left: 10px; padding-top: 0px; padding-bottom: 0px;">	
				<p><b>Step 7: Draw the graphic</b></p>
				<p>There are many options for doing this. I opted to use PILLOW and specifically the line command, which allowed me to pass image “coordinates” corresponding to the start and end point of each tile section. In the case of bends and corners, I simply had to add a the tile’s center coordinates in-between the start and end points, and specify a radius.</p>
				<p>Drawing the same line twice with different colours and line width allows us to achieve a line stroke effect.</p>
			</div>
			<p></p>
			<div style="border-left: 5px solid; border-color: rgb(91, 70, 54); padding-left: 10px; padding-top: 0px; padding-bottom: 0px;">
				<p><b>Step 8: Identify crossing points and apply over-crossings</b></p>
				<p>Identifying the crossings turns out to be straightforward: every bend has a single crossing at the non-orthogonal point and every diagonal has a crossing at each non-orthogonal point (1 over, 1 under).</p>
				<p>Determining the “overs” and “unders” isn’t too hard either – at each crossing point, NW to SE lines go “over” on odd rows, NE to SW lines go “over” on even rows. In the case of bends, which always have one NE / SE / SW / NW and one N / E / S / W, we can consider (for example) W to SE as if it were NW to SE and thus “over” on odd rows.</p>
				<img class="responsive-img" style="width: 65%" src="./assets/20250202/20250202-13.png" alt="Step 8">
			</div>
			<p>Now, I’m conscious that there are some limitations with this method, which is essentially covering-over the existing graphic. In my implementation I’m also drawing each “over” section twice, once for each “over” tile at the crossing point. That said, it’s simple and works, so hey. I initially intended to compute the “overs” and “unders” before drawing the graphic, but realised that each tile is often both under and over other tiles. </p>
			<p></p>
			<b>In good company</b>
			<p>There are probably countless examples of similar programs on the web – realising this only after finishing (which is definitely for the best or I wouldn’t have had the problem-solving challenge!) I’ve had a look at (in no particular order):</p>
			<ul>
				<li>birrell.org [<a href="http://birrell.org/andrew/knotwork/">http://birrell.org/andrew/knotwork/</a>] (who also read George Bain)</li>
				<li>The Celtic Knot font [<a href="http://clanbadge.com/">http://clanbadge.com/</a>]</li>
				<li>Grid Maker [<a href="https://www.freakinsweetapps.com/knots/knotgrid/advanced.html">https://www.freakinsweetapps.com/knots/knotgrid/advanced.html</a>]</li>
				<li>KnotsBag [<a href="http://www.hypatiasoft.fr/Folder_KnotsBag/Pages_HTML/KnotsBag_A.html">http://www.hypatiasoft.fr/Folder_KnotsBag/Pages_HTML/KnotsBag_A.html</a>]</li>
				<li>Knots3D [<a href="https://www.stevenabbott.co.uk/Knots/knots.html">https://www.stevenabbott.co.uk/Knots/knots.html</a>]</li>
				<li>knotTyer3D [<a href="https://www.stevenabbott.co.uk/Knots/knottyer3d.html">https://www.stevenabbott.co.uk/Knots/knottyer3d.html</a>]</li>
				<li>knotplot [<a href="https://knotplot.com/">https://knotplot.com/</a>] (mathematically oriented)</li>
				<li>knotter [<a href="https://gitlab.com/mattbas/Knotter">https://gitlab.com/mattbas/Knotter</a>] (mathematically oriented)</li>
			</ul>
			<p>Finally, a nod to <a href="https://www.oranlooney.com/post/genji-ko/">this fantastic project</a> which algorithmically generates and draws the South Korean Genjiko patterns (except for a few which seemingly break the rules!).</p>
			<p></p>
			<div class="separator"></div>
			<p></p>
			<div id="knotiframe" style="width: 100%; position: relative; overflow: hidden; padding-top: 250%">
				<iframe load="lazy" style="position: absolute; top: 0; left: 0; bottom: 0; right: 0; width: 100%; height: 100%; border: none" src="https://2earth.pyscriptapps.com/celtic-knot/latest/"></iframe>
			</div>
			<p></p>
			<div class="separator"></div>
		</div>
		
		<p></p>
	<div class="breakout">
		Thanks for reading! If you enjoyed this and would like to stay in touch, consider <a href="./subscribe.html">subscribing</a> to this blog - you'll receive an email whenever I next add an entry. Cheers!
	</div>

  

</body>
</html>